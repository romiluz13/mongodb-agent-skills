{
  "invariants": [
    {
      "file": "mongodb-ai/rules/index-automated-embedding.md",
      "requiredHeadings": [
        "Automated Embedding Generation",
        "Verify with"
      ],
      "requiredPhrases": [
        "Community Edition 8.2+",
        "Atlas private preview path"
      ],
      "exampleAssertions": [
        {
          "kind": "good",
          "containsAll": [
            "type: \"autoEmbed\"",
            "modality: \"text\""
          ],
          "message": "Good example must show autoEmbed index definition"
        },
        {
          "kind": "good",
          "containsAll": [
            "query: { text:"
          ],
          "message": "Good example must show text-query syntax for automated embedding"
        }
      ]
    },
    {
      "file": "mongodb-ai/rules/query-lexical-prefilter.md",
      "requiredPhrases": [
        "Public Preview",
        "distinct from the `$vectorSearch` aggregation stage"
      ],
      "exampleAssertions": [
        {
          "kind": "good",
          "containsAll": [
            "$search",
            "vectorSearch",
            "fuzzy"
          ],
          "message": "Good example must include $search.vectorSearch lexical prefilter usage"
        }
      ]
    },
    {
      "file": "mongodb-ai/rules/hybrid-rankfusion.md",
      "requiredPhrases": [
        "MongoDB 8.0+",
        "MongoDB 8.1+",
        "MongoDB 8.2+"
      ],
      "exampleAssertions": [
        {
          "kind": "good",
          "containsAll": [
            "$rankFusion",
            "$vectorSearch",
            "$search"
          ],
          "message": "Good example must combine vector and lexical pipelines under $rankFusion"
        }
      ]
    },
    {
      "file": "mongodb-ai/rules/hybrid-scorefusion.md",
      "requiredPhrases": [
        "MongoDB 8.2+",
        "Preview features"
      ],
      "exampleAssertions": [
        {
          "kind": "good",
          "containsAll": [
            "$scoreFusion"
          ],
          "message": "Good example must include $scoreFusion"
        }
      ]
    },
    {
      "file": "mongodb-ai/rules/query-vectorsearch-first.md",
      "requiredPhrases": [
        "$unionWith",
        "8.0+"
      ],
      "exampleAssertions": [
        {
          "kind": "good",
          "containsAll": [
            "$vectorSearch",
            "filter"
          ],
          "message": "Good example must preserve first-stage and filter guidance"
        }
      ]
    },
    {
      "file": "mongodb-ai/rules/query-get-scores.md",
      "requiredPhrases": [
        "fixed range of `0` to `1`",
        "Starting in MongoDB 8.2",
        "Do not treat it as a raw cosine, Euclidean distance, or dot-product value."
      ],
      "exampleAssertions": [
        {
          "kind": "good",
          "containsAll": [
            "$project",
            "$meta: \"vectorSearchScore\""
          ],
          "message": "Good example must project vectorSearchScore metadata directly from the query pipeline"
        }
      ]
    },
    {
      "file": "mongodb-query-and-index-optimize/rules/perf-query-stats.md",
      "requiredPhrases": [
        "MongoDB 8.2+",
        "cpuNanos",
        "delinquency",
        "Stability caveat"
      ],
      "exampleAssertions": [
        {
          "kind": "good",
          "containsAll": [
            "$queryStats"
          ],
          "message": "Good example must include $queryStats usage"
        }
      ]
    },
    {
      "file": "mongodb-query-and-index-optimize/rules/perf-query-settings.md",
      "requiredPhrases": [
        "8.1",
        "8.0.4",
        "deprecated"
      ],
      "exampleAssertions": [
        {
          "kind": "good",
          "containsAll": [
            "setQuerySettings"
          ],
          "message": "Good example must include setQuerySettings usage"
        }
      ]
    },
    {
      "file": "mongodb-query-and-index-optimize/rules/query-bulkwrite-command.md",
      "requiredPhrases": [
        "single-request cross-collection batch",
        "Use a transaction"
      ],
      "exampleAssertions": [
        {
          "kind": "good",
          "containsAll": [
            "bulkWrite"
          ],
          "message": "Good example must include bulkWrite usage"
        }
      ]
    },
    {
      "file": "mongodb-schema-design/rules/validation-action-levels.md",
      "requiredPhrases": [
        "errorAndLog",
        "downgrade"
      ]
    },
    {
      "file": "mongodb-schema-design/rules/validation-rollout-strategy.md",
      "requiredPhrases": [
        "errorAndLog",
        "downgrade"
      ]
    },
    {
      "file": "mongodb-transactions-consistency/rules/retry-unknown-commit-result.md",
      "requiredPhrases": [
        "UnknownTransactionCommitResult",
        "Retrying commit resolves uncertainty"
      ],
      "exampleAssertions": [
        {
          "kind": "good",
          "containsAll": [
            "commitTransaction",
            "UnknownTransactionCommitResult"
          ],
          "message": "Good example must include commit retry loop for unknown commit result"
        }
      ]
    },
    {
      "file": "mongodb-transactions-consistency/rules/retry-upsert-duplicate-key-81.md",
      "requiredPhrases": [
        "MongoDB 8.1",
        "duplicate-key"
      ],
      "exampleAssertions": [
        {
          "kind": "good",
          "containsAll": [
            "upsert: true",
            "e.code === 11000"
          ],
          "message": "Good example must handle duplicate-key upsert conflicts explicitly"
        }
      ]
    },
    {
      "file": "mongodb-transactions-consistency/rules/fundamental-primary-read-preference.md",
      "requiredPhrases": [
        "primary read preference",
        "transaction-level read preference"
      ],
      "exampleAssertions": [
        {
          "kind": "good",
          "containsAll": [
            "readPreference: \"primary\""
          ],
          "message": "Good example must set primary read preference for transaction options"
        }
      ]
    }
  ]
}
