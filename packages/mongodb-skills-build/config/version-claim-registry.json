{
  "global": {
    "enforceOfficialReferenceForVersionClaims": true,
    "versionClaimPattern": "\\bMongoDB\\s+8\\.\\d(?:\\.\\d+)?\\+?|\\b8\\.\\d\\+\\b|\\b8\\.0\\.4\\b",
    "officialReferencePattern": "^Reference:\\s+.*https?:\\/\\/(?:www\\.)?mongodb\\.com\\/docs\\/"
  },
  "pathRules": [
    {
      "pathRegex": "^mongodb-.+/rules/(?!_).+\\.md$",
      "requirements": [
        {
          "pattern": "^Reference:",
          "flags": "m",
          "message": "Rule file must include a Reference line"
        }
      ]
    },
    {
      "pathRegex": "^mongodb-(query-and-index-optimize|schema-design)/rules/(?!_).+\\.md$",
      "requirements": [
        {
          "pattern": "^## Verify with$",
          "flags": "m",
          "message": "Missing required \"## Verify with\" section"
        }
      ]
    },
    {
      "pathRegex": "^mongodb-ai/rules/(?!_).+\\.md$",
      "requirements": [
        {
          "pattern": "^## Verify with$",
          "flags": "m",
          "message": "Missing required \"## Verify with\" section in MongoDB.AI rule"
        }
      ]
    },
    {
      "pathRegex": "^mongodb-transactions-consistency/rules/(?!_).+\\.md$",
      "requirements": [
        {
          "pattern": "^## Verify with$",
          "flags": "m",
          "message": "Missing required \"## Verify with\" section in transactions rule"
        }
      ]
    },
    {
      "pathRegex": "^mongodb-ai/rules/hybrid-(rankfusion|scorefusion|limitations|weights)\\.md$",
      "requirements": [
        {
          "pattern": "\\bpreview\\b",
          "flags": "i",
          "message": "Hybrid fusion rule must include preview-status guidance"
        }
      ]
    }
  ],
  "fileRules": [
    {
      "file": "mongodb-ai/rules/hybrid-rankfusion.md",
      "requirements": [
        {
          "pattern": "MongoDB 8\\.0\\+",
          "message": "must keep rankFusion 8.0+ gate"
        },
        {
          "pattern": "MongoDB 8\\.1\\+",
          "message": "must keep vectorSearch-in-input 8.1+ gate"
        },
        {
          "pattern": "MongoDB 8\\.2\\+",
          "message": "must keep view support 8.2+ gate"
        }
      ]
    },
    {
      "file": "mongodb-ai/rules/hybrid-scorefusion.md",
      "requirements": [
        {
          "pattern": "MongoDB 8\\.2\\+",
          "message": "must keep scoreFusion 8.2+ gate"
        }
      ]
    },
    {
      "file": "mongodb-ai/rules/query-vectorsearch-first.md",
      "requirements": [
        {
          "pattern": "\\$unionWith",
          "flags": "i",
          "message": "must retain $unionWith nuance"
        },
        {
          "pattern": "8\\.0\\+",
          "message": "must retain 8.0+ gate for $unionWith vectorSearch context"
        }
      ]
    },
    {
      "file": "mongodb-ai/rules/query-lexical-prefilter.md",
      "requirements": [
        {
          "pattern": "Public Preview",
          "message": "must keep lexical prefilter preview-status guidance"
        },
        {
          "pattern": "\\$search",
          "message": "must keep $search.vectorSearch guidance"
        },
        {
          "pattern": "distinct from the `\\$vectorSearch` aggregation stage",
          "message": "must preserve distinction from $vectorSearch stage behavior"
        }
      ]
    },
    {
      "file": "mongodb-ai/rules/query-prefiltering.md",
      "requirements": [
        {
          "pattern": "\\$exists",
          "message": "must keep $exists pre-filter operator guidance"
        },
        {
          "pattern": "\\$ne to null",
          "message": "must keep $ne-to-null pre-filter guidance"
        },
        {
          "pattern": "\\$not",
          "message": "must keep $not pre-filter guidance"
        }
      ]
    },
    {
      "file": "mongodb-ai/rules/index-hnsw-options.md",
      "requirements": [
        {
          "pattern": "\\| `maxEdges` \\| 16 \\| 16-64 \\|",
          "message": "must keep maxEdges default and bounds guidance"
        },
        {
          "pattern": "\\| `numEdgeCandidates` \\| 100 \\| 100-3200 \\|",
          "message": "must keep numEdgeCandidates default and bounds guidance"
        }
      ]
    },
    {
      "file": "mongodb-ai/rules/index-dimensions-match.md",
      "requirements": [
        {
          "pattern": "Maximum supported dimensions:\\s*8192",
          "message": "must keep 8192 max-dimension guidance"
        }
      ]
    },
    {
      "file": "mongodb-ai/rules/index-vector-definition.md",
      "requirements": [
        {
          "pattern": "<= 8192",
          "message": "must keep vector definition dimension ceiling guidance"
        }
      ]
    },
    {
      "file": "mongodb-ai/rules/index-automated-embedding.md",
      "requirements": [
        {
          "pattern": "autoEmbed",
          "message": "must keep self-managed automated embedding syntax guidance"
        },
        {
          "pattern": "Community Edition 8\\.2\\+",
          "message": "must keep Community Edition 8.2+ version boundary"
        },
        {
          "pattern": "Atlas private preview",
          "flags": "i",
          "message": "must keep Atlas private-preview boundary guidance"
        }
      ]
    },
    {
      "file": "mongodb-query-and-index-optimize/rules/perf-query-settings.md",
      "requirements": [
        {
          "pattern": "\\b8\\.1\\b",
          "message": "must retain 8.1 setQuerySettings.comment guidance"
        },
        {
          "pattern": "\\b8\\.0\\.4\\b",
          "message": "must retain 8.0.4 backport note for setQuerySettings.comment"
        },
        {
          "pattern": "deprecated|deprecation",
          "flags": "i",
          "message": "must retain index filter deprecation guidance"
        }
      ]
    },
    {
      "file": "mongodb-query-and-index-optimize/rules/perf-query-stats.md",
      "requirements": [
        {
          "pattern": "MongoDB 8\\.1\\+",
          "message": "must keep 8.1 count/distinct compatibility guidance"
        },
        {
          "pattern": "MongoDB 8\\.2\\+",
          "message": "must keep 8.2 metrics guidance"
        },
        {
          "pattern": "Stability caveat",
          "flags": "i",
          "message": "must include queryStats stability caveat"
        },
        {
          "pattern": "cpuNanos",
          "message": "must include cpuNanos 8.2+ diagnostics guidance"
        },
        {
          "pattern": "delinquency",
          "flags": "i",
          "message": "must include delinquency metrics guidance"
        }
      ]
    },
    {
      "file": "mongodb-query-and-index-optimize/rules/query-bulkwrite-command.md",
      "requirements": [
        {
          "pattern": "single-request cross-collection batch",
          "flags": "i",
          "message": "must keep non-atomic single-request bulkWrite framing"
        },
        {
          "pattern": "Use a transaction",
          "flags": "i",
          "message": "must keep transaction fallback for atomic all-or-nothing behavior"
        }
      ],
      "prohibitions": [
        {
          "pattern": "atomic cross-collection batch operations",
          "message": "must not claim bulkWrite cross-collection atomicity"
        }
      ]
    },
    {
      "file": "mongodb-schema-design/rules/validation-action-levels.md",
      "requirements": [
        {
          "pattern": "errorAndLog",
          "message": "must keep errorAndLog guidance"
        },
        {
          "pattern": "downgrade",
          "flags": "i",
          "message": "must keep downgrade caveat"
        }
      ]
    },
    {
      "file": "mongodb-schema-design/rules/validation-rollout-strategy.md",
      "requirements": [
        {
          "pattern": "errorAndLog",
          "message": "must keep errorAndLog rollout guidance"
        },
        {
          "pattern": "downgrade",
          "flags": "i",
          "message": "must keep downgrade rollback guidance"
        }
      ]
    },
    {
      "file": "mongodb-query-and-index-optimize/rules/_sections.md",
      "requirements": [
        {
          "pattern": "single-request cross-collection batch operations",
          "message": "section summary must reflect non-atomic bulkWrite wording"
        },
        {
          "pattern": "all-or-nothing atomicity",
          "message": "section summary must mention transaction requirement for atomicity"
        },
        {
          "pattern": "8\\.1 adds count/distinct coverage; 8\\.2 adds delinquency and CPU metrics",
          "message": "section summary must include queryStats version-delta guidance"
        }
      ],
      "prohibitions": [
        {
          "pattern": "atomic cross-collection batch operations",
          "message": "section summary must not claim bulkWrite cross-collection atomicity"
        },
        {
          "pattern": "MongoDB 8\\.0 introduced `\\$queryStats`",
          "message": "section summary must not claim 8.0 introduced $queryStats"
        }
      ]
    },
    {
      "file": "mongodb-ai/rules/_sections.md",
      "requirements": [
        {
          "pattern": "fusion-stage capabilities as Preview features",
          "message": "hybrid section summary must include fusion preview-status guidance"
        },
        {
          "pattern": "Lexical Prefilters - November 2025 Public Preview",
          "message": "query section summary must include lexical prefilter preview guidance"
        }
      ]
    },
    {
      "file": "mongodb-transactions-consistency/rules/retry-upsert-duplicate-key-81.md",
      "requirements": [
        {
          "pattern": "MongoDB 8\\.1",
          "message": "must keep MongoDB 8.1 duplicate-key upsert guidance"
        },
        {
          "pattern": "duplicate-key",
          "flags": "i",
          "message": "must keep duplicate-key conflict framing"
        }
      ]
    },
    {
      "file": "mongodb-transactions-consistency/rules/retry-unknown-commit-result.md",
      "requirements": [
        {
          "pattern": "UnknownTransactionCommitResult",
          "message": "must keep unknown commit result retry label guidance"
        },
        {
          "pattern": "commit",
          "flags": "i",
          "message": "must keep commit-retry guidance"
        }
      ]
    }
  ]
}
